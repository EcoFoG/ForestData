---
title: 'Retrieving POMs for Paracou: traceback'
author: "Nino PAGE"
date: "30 octobre 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = TRUE)
options(knitr.table.format = "html")
library(tidyverse)
library(kableExtra)
library(gtable)
```

# Foreword

Comparing Forest Censuses from different stations and obtained with different protocols and conventions can be quite challenging. A critical point to achieve such a goal is to trace the Point Of Measurements (hereafter, POMs) in order to calculate stand descriptors on a same basis. Recent forest plot networks such as RainFor aim at standardizing datasets and claim explicit POMs measurements, but this practice has not always been adopted in older experimental designs, thus making the integration of valuable datasets somehow difficult. This is the case for forest censuses obtained from the Paracou Disturbance Experiment, in which a measure code supposed to indicate changes in POM is attached to every tree measurement, instead of explicitly register measurement height -probably for efficiency concerns. Its use has been sometimes equivocal, and quite a debate arose around the existence of differences between the putative use of the codes, and what happened and happens in the field. This document retraces my attempt to retrieve POMs for the whole Paracou database.

# Why do we need POMs ?

Several reasons motivated this endeavor to reconstitute a POM field in the Paracou database. First of all, althought changes in POM apparently concern a few trees (3790 reported changes, out of 1.500.000 measurements on 100.000 individuals), strict rigor involves to account for the shift in tree size trajectories induces by such events, be it to estimate the epigeic biomass for trees over 10cm DBH, or other stand descriptors such as basal area, extractible timber volumes and growth rates. The less bias, the best, even if basal measurement alea is irreducible and if the marginal gain of these correction can be weak (depending on the stand descriptor we consider). Second, in a perspective of growing collaboration and comparison worldwide, a part or all of the Paracou database is intended to be more widely used, compared, and integrated to forest plot networks such as RainFor. This implies to make it comparable to other forests plot, and/or to comply with the required data format. Both result in the need to retrace POMs and include it explicitely in the database. Finally, the Paracou database serves as a testset for the development of the package ForestData, aimed at proposing standardised corrections for a variety of frequent measurement errors on forest censuses. One of the functions of the package will correct circumference or diameter measurements, based on POMs and threshold or outlyer detection techniques. To design and test the package and ensure that it performs well, we need to have a dataset that include explicit, reliable POMs records. 

# Prime material

## Measure codes

In Paracou Censuses, a measure code is attached to every tree measurement, and is supposed to indicate whether the measurement has been performed "normally" or not, and report usual cases and actions to obtain the circumference or diameter value, and treat these cases more efficiently than if included as commentaries. Here, I present the codes and their alleged meanings, based on the document written by Aur√©lie Dourdain that explains detailedly every aspect of the GuyaFor protocol. Every additional information one needs can be find in this document.


```{r codes, echo = F}

table <- data.frame("Measure Code" = c(0,
                                        1,
                                        2,
                                        3,
                                        4,
                                        7,
                                        9,
                                        10,
                                        11,
                                        12),
                    "Description" = c("Normal\ tree measured\ at\ breast\ height\ (1.3\ m)\ or\ above\ buttresses",
                                      "Measurement\ point\ raised\ by\ 0.5\ m",
                                      "Measurement\ point\ raised\ by\ 1\ m",
                                      "Measurement\ point\ raised\ by\ 1.5\ m",
                                      "Tree\ for\ which\ size\ is\ estimated\ or\ uncertain\ (unusual\ shape)",
                                      "Tree\ damaged\ during\ logging",
                                      "Poisoned\ tree",
                                      "Tree\ measured\ using\ a\ ladder",
                                      "Naturally\ damaged\ tree",
                                      "Leaning\ tree\ still\ alive")
                    )

knitr::kable(table) %>% kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"),full_width = T)

```

Additionnal remarks are attached to these codes, we will focus on the codes 0, 1, 2, 3, and 10 only:
* $Code\ 0:$ Regular tree measured at breast height (1.3m, measured using a stick of this length) or above its buttresses. Height of measurement is systematically materialized by a paint mark.
* $Codes\ 1,\ 2\ and\ 3:$ When circumference can be normally measured at breast height because of buttresses, swelling or constrictions, the measurement height is raised by at least 50cm above it. In this case, the worker can use a 4m high ladder, taking the measure up to 5m. For big trees that require a ladder, no need to do a continuous paint mark. The codes are attributed according to the change in ainting mark (thus, measurement height), and correspond respectively to a raise of 50, 100 and 150 centimeters

## Remarks

First of all, it seems that the main weakness in this measurement code's design is that several information of different nature, and that are non-mutually exclusive

The meaning of the codes and the way they are used in the field is rather equivocal. One can first understand that every tree with code 1, 2 or 3 is measured at 1.3+code*0.5 m above the ground, and that once the POM changes, the code is repeated over years unless it is further raised. This is not the case, and we all agree that the descriptions in the database's metada needs to be clarified to minimize the effort for persons that are not completely familiar with the detailed protocol. Indeed, as interpreted by the fieldworkers and the database's referents, the codes from 1 to 3 are used when the POM has to be changed, and appears only for the corresponding years, the measurement code being subsequently reset to 0. Thus, the new code explanations would have to be like this:

* $Code\ 0:$ Tree measured with $the\ same\ POM\ as\ for\ the\ previous\ year$. If the tree has just been recruited, the default POM is 130cm, unless a ladder was used (see the code_ladder field).

* $Code\ 1\ to\ 3:$ If the circumference $cannot\ be\ obtained\ at\ the\ same\ POM\ as\ previously$ (or at 130cm in case of first register), the POM is raised by 50, 100 or 150 cm for the codes 1, 2 and 3 respectively. The code appears $for\ the\ census\ at\ which\ the\ POM\ changes$ and is put back to 0 for the next censuses, unless (and/or untill) it will have to be raised again.

The main problem of this code is that we might doubt that it has been use the right way, since it is equivocal. Prior to simply use the code
