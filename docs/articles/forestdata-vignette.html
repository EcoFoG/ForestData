<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to use ForestData's corrections • ForestData</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How to use ForestData's corrections">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ForestData</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/forestdata-vignette.html">How to use ForestData's corrections</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>How to use ForestData’s corrections</h1>
                        <h4 class="author">Nino Page</h4>
            
      
      
      <div class="hidden name"><code>forestdata-vignette.Rmd</code></div>

    </div>

    
    
<div id="what-is-forestdata" class="section level1">
<h1 class="hasAnchor">
<a href="#what-is-forestdata" class="anchor"></a>What is ForestData ?</h1>
<p>ForestData is a package that gathers methods to works with dendrometric censuses datasets.</p>
<p>In particular, ForestData has been designed especially to implement and make available Camille Piponiot’s corrections algorithms, but it also includes other functions to compute classical rates or metrics (basal area, stem growth, mortality and recruitment) and display them efficiently.</p>
<p>This vignette details how to use these functions, step by step and using the built-in example dataset. ForestData has three main “families” of functions depending on what is intended to do: <code>correct_</code>,<code>compute_</code> and <code>display_</code>. Each “family” will be detailed, so if you only are interested by one of these items, you can jump directly to the corresponding section.</p>
</div>
<div id="install-and-load-the-package" class="section level1">
<h1 class="hasAnchor">
<a href="#install-and-load-the-package" class="anchor"></a>Install and load the package</h1>
<p>ForestData is not yet published on the CRAN. It can easily be downloaded from EcoFoG’s github repository (on <a href="https://github.com/EcoFoG/ForestData">this page</a>) and compiled locally, and even more easily be installed directly into R with devtools’ <code>install_github</code> function. You can use the following code to install ForestData.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="op">!</span><span class="st">"ForestData"</span> <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span>()){
  
  <span class="cf">if</span>(<span class="op">!</span><span class="st">"devtools"</span> <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span>()){
    <span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>)
  }
  
  devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"EcoFoG/ForestData"</span>)
} 

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ForestData)</code></pre></div>
</div>
<div id="use-forestdata-to-correct-dendrometric-censuses-data" class="section level1">
<h1 class="hasAnchor">
<a href="#use-forestdata-to-correct-dendrometric-censuses-data" class="anchor"></a>Use ForestData to correct dendrometric censuses data</h1>
<p>The main goal of ForestData is to provide generic and simple corrections adapted for forest censuse.Three functions are implemented in order to correct different error sources in such datasets:</p>
<ul>
<li>Tree life status can have errors due to non-observation of some trees, or mistaken death statement. This impacts mortality computations. The implemented function is able to spot when a tree has not been seen, or if it has been stated dead but is seen alive afterwards, and thus correct the tree’s life history, and re-creates the missing lines (with NA measurements) when needed.</li>
<li>Tree size measurements can be mistaken due to many reasons, including POM shifts or difficulties in measurement due to non-cylindric conformation. With POM reports, the implemented algorithm first corrects the size series shifts due to POM changes and then spot abnormal increases or decreases in size, and correct them according to the nature of such anomalies (punctual, permanent…), accounting for positive and negative thresholds as well as whether the trees belong to pioneer species or not.</li>
<li>Overgrown recruits are trees registered after the first census of the experiment, but with a size that suggests they just weren’t seen before, although they were already there and with a stem over the minimal censusing diameter limit. These trees can represent a non-negligible error in terms of biomass or basal area, and it is sometimes needed to correct a dataset by re-creating missed measurements before their first record. Being highly hypothetical, such a correction has to be done as parcimoniously as possible (and only used when there is no alternative). There is a function in ForestData that offers a way to do so.</li>
</ul>
<p>After presenting the format and contents of the dataset and a preparation function that simplifies the correction functions calls, we’ll go through the presentation of each function in the recommended order (correct_alive, correct_size, correct_recruits). The details of the corrections are found after the examples to simplify the introduction to the package.</p>
<div id="prepare-your-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#prepare-your-dataset" class="anchor"></a>Prepare your dataset</h2>
<div id="a-forest-census-data-structure" class="section level3">
<h3 class="hasAnchor">
<a href="#a-forest-census-data-structure" class="anchor"></a>A Forest census: data structure</h3>
<p>The type of dataset that Forestdata’s function are designed to treat is a long-format time series: each line corresponds to a single tree measurements at one census time. Furthermore, the dataset must respect those conditions:</p>
<ul>
<li>Census time is, in our case, specified in a dedicated field and expressed only as census year (thus, numeric) as infra-annual time resolution is not supported for now.</li>
<li>Individual trees are tagged with IDs that must be unique among the dataset. Moreover, each ID must correspond to only one stem: multiple stems of the same individual must be discriminated by the IDs to be supported by this package’s functions.</li>
<li>Tree life status is specified in one dedicated field, and trees are either alive (1), dead (0) or unseen at a given census time (NA).</li>
<li>Tree stem size can correspond to either diameter of circumference, and is measured in centimeters (cm) at a given default POM ( Point Of Measurement; generally at “breast height”, i.e. 130 cm).</li>
<li>The dataset can include censuses for one or several forest plots. If there are several, a dedicated field must specify to which plot belongs each tree.</li>
<li>A field indicating taxonomic identification (binomial species name) is needed.</li>
</ul>
<p>To illustrate the following explanations, a built-in example dataset will be used. It corresponds to the squares 1 and 3 of the 6th Plot of the Paracou Experiment database (more information <a href="https://paracou.cirad.fr/">here</a>)</p>
<p>The dataset can be loaded using the function <code><a href="https://rdrr.io/r/utils/data.html">utils::data</a></code>.</p>
<p>Let’s take a look to its structure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(example_census)
<span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(example_census)
<span class="co">#&gt; 'data.frame':    25533 obs. of  12 variables:</span>
<span class="co">#&gt;  $ Forest       : chr  "Paracou:P6" "Paracou:P6" "Paracou:P6" "Paracou:P6" ...</span>
<span class="co">#&gt;  $ Plot         : int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ idTree       : int  100621 100621 100621 100621 100621 100621 100621 100621 100621 100621 ...</span>
<span class="co">#&gt;  $ Family       : chr  "Euphorbiaceae" "Euphorbiaceae" "Euphorbiaceae" "Euphorbiaceae" ...</span>
<span class="co">#&gt;  $ Genus        : chr  "Sandwithia" "Sandwithia" "Sandwithia" "Sandwithia" ...</span>
<span class="co">#&gt;  $ Species      : chr  "guyanensis" "guyanensis" "guyanensis" "guyanensis" ...</span>
<span class="co">#&gt;  $ CensusYear   : int  1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 ...</span>
<span class="co">#&gt;  $ CodeAlive    : logi  TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  $ CodeMeas     : int  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ Circ         : num  40 40 40 40.5 40.5 41.5 40.5 40.5 40.5 41 ...</span>
<span class="co">#&gt;  $ binomial_name: chr  "Sandwithia_guyanensis" "Sandwithia_guyanensis" "Sandwithia_guyanensis" "Sandwithia_guyanensis" ...</span>
<span class="co">#&gt;  $ POM          : num  1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 ...</span></code></pre></div>
<p>The information used by ForestData’s functions is contained in the following columns of this dataset:</p>
<ul>
<li>
<code>idTree</code> contains unique tree IDs.</li>
<li>
<code>CensusYear</code> contains census year corresponding to each tree measurement. The census resolution is originally yearly from 1984 to 1995 included, then biannual from 1995 to 2003 included</li>
<li>
<code>Circ</code> contains the stem size measured as <em>circumference</em>. In most cases, circumference is measured <em>at breast height (default POM: 130 cm)</em>.</li>
<li>
<code>binomial_name</code> contains the full species name of the measured trees. This information is used in <code>correct_size</code> to discriminate pioneer species from other species, because their growth rates are drastically different.</li>
<li>
<code>Plot</code> contains plot indices. This is important for the functions <code>correct_alive</code> and <code>correct_recruits</code>, since the plots have different temporal resolution in this example.</li>
<li>
<code>POM</code> contains the Point of Measurement (POM) values, that is, the height at which tree size (circumference of diameter) is measured.</li>
</ul>
<p>All the other columns are only additional information: Family, Genus and Species are taxonomical information and Forest is a geographical indication (where is located the plot to which the tree belongs). This information is invariant for a given tree among its different measurements.</p>
</div>
<div id="use-prepare_forestdata-to-simplify-your-workflow" class="section level3">
<h3 class="hasAnchor">
<a href="#use-prepare_forestdata-to-simplify-your-workflow" class="anchor"></a>Use <code>prepare_forestdata</code> to simplify your workflow</h3>
<p>ForestData’s functions have a lot of arguments, including because there is no constraints on the user side for the dataset’s column names, and to allow the user setting the functions entirely to adapt it to every specific dataset…</p>
<p>However, most of these arguments are redundant and it can be exhausting to write long calls, only to specify column names for every step.</p>
<p>Fortunately, there is a function that does the job for you: <code>prepare_forestdata</code>. If you specify everything only once using this function, your argument settings will be kept in memory and called automatically by the functions.</p>
<p>For example, let’s specify the column names that ForestData needs to correct our dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># specify the example dataset's column names</span>
<span class="kw"><a href="../reference/prepare_forestdata.html">prepare_forestdata</a></span>(example_census,
                   <span class="dt">plot_col=</span><span class="st">"Plot"</span>,
                   <span class="dt">id_col=</span><span class="st">"idTree"</span>,
                   <span class="dt">time_col=</span><span class="st">"CensusYear"</span>, 
                   <span class="dt">status_col =</span> <span class="st">"CodeAlive"</span>,
                   <span class="dt">size_col=</span><span class="st">"Circ"</span>,
                   <span class="dt">measure_type =</span> <span class="st">"C"</span>,
                   <span class="dt">POM_col =</span> <span class="st">"POM"</span>)</code></pre></div>
<p>As you can see, the arguments of <code>prepare_forestdata</code> are the dataset you are going to run corrections on, the “type of measurement” (either “C” for circumference or “D” for diameter), and the names of the columns containing the informations needed for corrections to run, i.e.:</p>
<ul>
<li>Plot indices</li>
<li>Unique tree ids</li>
<li>Census year</li>
<li>Tree vital status</li>
<li>Tree stem size measurement</li>
<li>Point of Measurement</li>
</ul>
<p>The column names are simply called with <code>getOption</code> in the next functions. Let’s check that these values have been correctly set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># checking that the options have been set</span>
<span class="kw"><a href="https://rdrr.io/r/base/options.html">getOption</a></span>(<span class="st">"plot_col"</span>); <span class="kw"><a href="https://rdrr.io/r/base/options.html">getOption</a></span>(<span class="st">"time_col"</span>)
<span class="co">#&gt; [1] "Plot"</span>
<span class="co">#&gt; [1] "CensusYear"</span></code></pre></div>
<p>Note that if the function is run twice with similar specifications for one or several names, a message indicates that those ones kept unchanged</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># </span>
<span class="kw"><a href="../reference/prepare_forestdata.html">prepare_forestdata</a></span>(example_census,<span class="dt">plot_col=</span><span class="st">"Plot"</span>,<span class="dt">id_col=</span><span class="st">"idTree"</span>,<span class="dt">time_col=</span><span class="st">"CensusYear"</span>, <span class="dt">status_col =</span> <span class="st">"CodeAlive"</span>,<span class="dt">size_col=</span><span class="st">"Circ"</span>,<span class="dt">measure_type =</span> <span class="st">"C"</span>,<span class="dt">POM_col =</span> <span class="st">"POM"</span>)
<span class="co">#&gt; [1] "plot_col let to its default or previous value"</span>
<span class="co">#&gt; [1] "id_col let to its default or previous value"</span>
<span class="co">#&gt; [1] "time_col let to its default or previous value"</span>
<span class="co">#&gt; [1] "status_col let to its default or previous value"</span>
<span class="co">#&gt; [1] "size_col let to its default or previous value"</span>
<span class="co">#&gt; [1] "measure_type let to its default or previous value"</span>
<span class="co">#&gt; [1] "POM_col let to its default or previous value"</span></code></pre></div>
<p>Moreover, <code>prepare_forestdata</code> assures that your specifications are coherent: if one column name is erroneous, the function stops with an explicit error message.</p>
</div>
</div>
<div id="use-correct_alive-to-correct-tree-life-status-errors-in-your-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#use-correct_alive-to-correct-tree-life-status-errors-in-your-dataset" class="anchor"></a>Use <code>correct_alive</code> to correct tree life status errors in your dataset</h2>
<p>Forest censuses are all about tree life statuses: mortality and recruitment depend directly on these variables, and other metrics such as basal area of growth rates should be only computed for live trees. Thus, avoiding errors in tree life statuses is the prime step to ensure that these metrics can be correctly calculated for your forest plots.</p>
<p><code>correct_alive</code> takes your data with uncorrected tree life status as an input, and detects unseen trees (with no corresponding line or with NA status for a given census year). The function does it by plot if there are several plots with different censusing resolutions. It also spots “reviving” events (when a tree is declared dead but seen alive later on). The function returns the original dataset with additional lines created for unseen trees (in those cases, the trees are set with NA uncorrectedstatus, circumference, and POM), and a new field named “status_corr”.</p>
<p>Here is the full call for correct_alive, with our example dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
 <span class="co">#Correct it (full call)</span>
example_status_corr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/correct_alive.html">correct_alive</a></span>(example_census,
<span class="dt">id_col =</span> <span class="st">"idTree"</span>,
<span class="dt">time_col =</span> <span class="st">"CensusYear"</span>,
<span class="dt">status_col =</span> <span class="st">"CodeAlive"</span>,
<span class="dt">plot_col =</span> <span class="st">"Plot"</span>,
<span class="dt">byplot =</span> <span class="ot">TRUE</span>,
<span class="dt">dead_confirmation_censuses =</span> <span class="dv">2</span>,
<span class="dt">use_size =</span> <span class="ot">FALSE</span>,
<span class="dt">invariant_columns =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Genus"</span>,
<span class="st">"Species"</span>,
<span class="st">"Family"</span>,
<span class="st">"Forest"</span>,
<span class="st">"binomial_name"</span>))
<span class="co">#&gt; </span>
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|================================</span><span class="st">                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%
<span class="co">#&gt; Warning in .correct_alive_tree(data_plot[which(data_plot$id == i), ],</span>
<span class="co">#&gt; censuses, : tree 178729 has only been recorded dead. It might be that it</span>
<span class="co">#&gt; has been recruited and died on the same between-censuses interval. Please</span>
<span class="co">#&gt; verify it</span>
<span class="co">#&gt; </span>
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%
<span class="co">#&gt; Warning in .correct_alive_tree(data_plot[which(data_plot$id == i), ],</span>
<span class="co">#&gt; censuses, : tree 103043 has only been recorded dead. It might be that it</span>
<span class="co">#&gt; has been recruited and died on the same between-censuses interval. Please</span>
<span class="co">#&gt; verify it</span>
<span class="co">#&gt; Warning in .correct_alive_tree(data_plot[which(data_plot$id == i), ],</span>
<span class="co">#&gt; censuses, : tree 103044 has only been recorded dead. It might be that it</span>
<span class="co">#&gt; has been recruited and died on the same between-censuses interval. Please</span>
<span class="co">#&gt; verify it</span>
<span class="co">#&gt; Warning in .correct_alive_tree(data_plot[which(data_plot$id == i), ],</span>
<span class="co">#&gt; censuses, : tree 103046 has only been recorded dead. It might be that it</span>
<span class="co">#&gt; has been recruited and died on the same between-censuses interval. Please</span>
<span class="co">#&gt; verify it</span>
<span class="co">#&gt; Warning in .correct_alive_tree(data_plot[which(data_plot$id == i), ],</span>
<span class="co">#&gt; censuses, : tree 103177 has only been recorded dead. It might be that it</span>
<span class="co">#&gt; has been recruited and died on the same between-censuses interval. Please</span>
<span class="co">#&gt; verify it</span>
<span class="co">#&gt; Warning in .correct_alive_tree(data_plot[which(data_plot$id == i), ],</span>
<span class="co">#&gt; censuses, : tree 103178 has only been recorded dead. It might be that it</span>
<span class="co">#&gt; has been recruited and died on the same between-censuses interval. Please</span>
<span class="co">#&gt; verify it</span>
<span class="co">#&gt; Warning in .correct_alive_tree(data_plot[which(data_plot$id == i), ],</span>
<span class="co">#&gt; censuses, : tree 103191 has only been recorded dead. It might be that it</span>
<span class="co">#&gt; has been recruited and died on the same between-censuses interval. Please</span>
<span class="co">#&gt; verify it</span>
<span class="co">#&gt; Warning in .correct_alive_tree(data_plot[which(data_plot$id == i), ],</span>
<span class="co">#&gt; censuses, : tree 103193 has only been recorded dead. It might be that it</span>
<span class="co">#&gt; has been recruited and died on the same between-censuses interval. Please</span>
<span class="co">#&gt; verify it</span>
<span class="co">#&gt; Warning in .correct_alive_tree(data_plot[which(data_plot$id == i), ],</span>
<span class="co">#&gt; censuses, : tree 103343 has only been recorded dead. It might be that it</span>
<span class="co">#&gt; has been recruited and died on the same between-censuses interval. Please</span>
<span class="co">#&gt; verify it</span>
<span class="co">#&gt; Warning in .correct_alive_tree(data_plot[which(data_plot$id == i), ],</span>
<span class="co">#&gt; censuses, : tree 103379 has only been recorded dead. It might be that it</span>
<span class="co">#&gt; has been recruited and died on the same between-censuses interval. Please</span>
<span class="co">#&gt; verify it</span>
<span class="co">#&gt; Warning in .correct_alive_tree(data_plot[which(data_plot$id == i), ],</span>
<span class="co">#&gt; censuses, : tree 103567 has only been recorded dead. It might be that it</span>
<span class="co">#&gt; has been recruited and died on the same between-censuses interval. Please</span>
<span class="co">#&gt; verify it</span>
<span class="co">#&gt; Warning in .correct_alive_tree(data_plot[which(data_plot$id == i), ],</span>
<span class="co">#&gt; censuses, : tree 103618 has only been recorded dead. It might be that it</span>
<span class="co">#&gt; has been recruited and died on the same between-censuses interval. Please</span>
<span class="co">#&gt; verify it</span></code></pre></div>
<p>As you can see, warning messages are sent every time a tree has only one or several records with dead status. This is generally due to the succession of growth over minimum censusing size and death, between two consecutive census. Still, confirming it manually is always useful to ensure that there is no other anomaly.</p>
<p>The function takes 9 arguments as an input:</p>
<ul>
<li>The dataset to correct, a data.frame object.</li>
<li>The names of the 4 columns containing: tree IDs, census year, life status and plot (if relevant)</li>
<li>
<code>byplot</code>, TRUE or FALSE, indicates whether the correction should be done by plot or not. If not, no need to set <code>plot_col</code>.</li>
<li>
<code>dead_confirmation_censuses</code> is a threshold. It corresponds to the number of unsighting censuses, after which an unseen tree can be considered dead. In Paracou, we consider that a tree that hasn’t been seen during two consecutive censuses is likely to be dead… except if it is seen alive again, later on.</li>
<li>
<code>invariant_columns</code> contains the names of the columns that do not vary with time for a given tree (in our example dataset, taxonomic information and Forest). If new lines corresponding to unseen trees are added, this variables will be set to their unique value, and the other variables will be let to NA.</li>
<li>
<code>use_size</code> is an optional argument that should be deprecated. It allows to create a tree life status from tree size measurement if this field doesn’t exist in your dataset. It means that for any non-NA size measurement, the corresponding tree will be considered alive…</li>
</ul>
<p>This function, as well as the other correction functions, include a progress bar to give you a raw estimate of computation advancement in case you deal with particularly big datasets.</p>
<p>If you used prepare_forestdata to preset some of the arguments, the call can be written more shortly:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Correct it (short version with column names set with prepare_forestdata)</span>

example_status_corr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/correct_alive.html">correct_alive</a></span>(example_census,
<span class="dt">invariant_columns =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Genus"</span>,
<span class="st">"Species"</span>,
<span class="st">"Family"</span>,
<span class="st">"Forest"</span>,
<span class="st">"binomial_name"</span>))
<span class="co">#&gt; </span>
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|================================</span><span class="st">                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%</code></pre></div>
<p>Let’s now take a look to the corrected dataset’s structure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(example_census) <span class="co">#25533 </span>
<span class="co">#&gt; [1] 25533</span>
<span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(example_status_corr)
<span class="co">#&gt; 'data.frame':    25634 obs. of  13 variables:</span>
<span class="co">#&gt;  $ Forest       : chr  "Paracou:P6" "Paracou:P6" "Paracou:P6" "Paracou:P6" ...</span>
<span class="co">#&gt;  $ Plot         : int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ idTree       : int  100621 100621 100621 100621 100621 100621 100621 100621 100621 100621 ...</span>
<span class="co">#&gt;  $ Family       : chr  "Euphorbiaceae" "Euphorbiaceae" "Euphorbiaceae" "Euphorbiaceae" ...</span>
<span class="co">#&gt;  $ Genus        : chr  "Sandwithia" "Sandwithia" "Sandwithia" "Sandwithia" ...</span>
<span class="co">#&gt;  $ Species      : chr  "guyanensis" "guyanensis" "guyanensis" "guyanensis" ...</span>
<span class="co">#&gt;  $ CensusYear   : int  1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 ...</span>
<span class="co">#&gt;  $ CodeAlive    : logi  TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  $ CodeMeas     : int  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ Circ         : num  40 40 40 40.5 40.5 41.5 40.5 40.5 40.5 41 ...</span>
<span class="co">#&gt;  $ binomial_name: chr  "Sandwithia_guyanensis" "Sandwithia_guyanensis" "Sandwithia_guyanensis" "Sandwithia_guyanensis" ...</span>
<span class="co">#&gt;  $ POM          : num  1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 ...</span>
<span class="co">#&gt;  $ status_corr  : num  1 1 1 1 1 1 1 1 1 1 ...</span></code></pre></div>
<p>The function added 101 lines corresponding to unseen trees. In this example dataset, it corresponds to only 0.4% of the data, thanks to the field verification efforts of the Paracou team. This proportion might be higher, especially for uneasily accesible plots, and life status errors can cause a severe prejudice to mortality rates computation.</p>
</div>
<div id="use-correct_size-to-correct-tree-size-measurements" class="section level2">
<h2 class="hasAnchor">
<a href="#use-correct_size-to-correct-tree-size-measurements" class="anchor"></a>Use <code>correct_size</code> to correct tree size measurements</h2>
<p>Note: Tree height correction is over the scope of this package. In this vignette “tree size” thus refers to either diameter or circumference.</p>
<p>Here is the full call for correct_size. Here, we apply this correction to the dataset already corrected for life status. We recommend to follow this order.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example_size_corr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/correct_size.html">correct_size</a></span>(example_status_corr, <span class="co">#full</span>
  <span class="dt">size_col =</span> <span class="st">"Circ"</span>,
  <span class="dt">time_col =</span> <span class="st">"CensusYear"</span>,
  <span class="dt">status_col =</span> <span class="st">"status_corr"</span>, <span class="co"># Because we corrected life statuses beforehand</span>
  <span class="dt">species_col =</span> <span class="st">"binomial_name"</span>, 
  <span class="dt">id_col =</span> <span class="st">"idTree"</span>,
  <span class="dt">POM_col =</span> <span class="st">"POM"</span>,
  <span class="dt">measure_type =</span> <span class="st">"C"</span>,
  <span class="dt">positive_growth_threshold =</span> <span class="dv">5</span>,
  <span class="dt">negative_growth_threshold =</span> <span class="op">-</span><span class="dv">2</span>,
  <span class="dt">default_POM =</span> <span class="fl">1.3</span>,
  <span class="dt">pioneers =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Cecropia"</span>, <span class="st">"Pourouma"</span>), <span class="co">#Works with species or genera</span>
  <span class="dt">pioneers_treshold =</span> <span class="fl">7.5</span>,
  <span class="dt">ignore_POM =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Warnings are displayed for trees having only one (or no) non-NA size measurement.</p>
<p>The function has 14 arguments:</p>
<ul>
<li>The dataset to correct, a data.frame object.</li>
<li>The names of the 5 columns containing: <code>id_col</code> (tree IDs), <code>size_col</code> (tree sizes : circumference or diameter), <code>time_col</code> (census year), <code>status_col</code> (life status) and <code>plot_col</code> (plot, if relevant)</li>
<li>
<code>measure_type</code> (“C” or “D”) indicates whether measured are circumferences or diameters.</li>
<li>
<code>byplot</code>, TRUE or FALSE, indicates whether the correction should be done by plot or not. If not, no need to set <code>plot_col</code>.</li>
<li>
<code>positive_growth_threshold</code> and <code>negative_growth_threshold</code> correspond to positive (annual) and negative (absolute) tolerated growth rates, and constitute the interval out of which growth values are considered abnormal. These values are given in <em>cm(diameter)/year</em> and <em>cm(diameter)</em>, respectively.</li>
<li>
<code>POM_col</code> is the name of the column containing Point Of Measurement values. These are capital to complement the thresholds and detect POM shifts and the resulting size decreases, even when these are not violating the thresholds. <code>ignore_POM</code>(TRUE/FALSE) indicates whether POM-based corrections must be ignored or not, since many dataset do not include this information. We recommend to use this option only when there is no other alternative. Corrections are thus less precise than if POMs are available.</li>
<li>
<code>default_POM</code> is the POM at which trees are supposed to be measured (defaults to 1.3). Specifying int allows e.g. for trees always measured with a higher POM, to be informed that the measured sizes have no DBH equivalent.</li>
<li>
<code>pioneers</code> and <code>pioneers_threshold</code> are respectively the name list of pioneer species/genera that require applying a different upper limit for growth rate, since they grow faster than others. Species are discriminated with their names, which are in the column specified with <code>species_col</code>.</li>
</ul>
<p>If one used prepare_forestdata and corrected for life status beforehand, one has to specify the column containig species names, the positive, negative and pioneers’ thresholds, and the name of the fast growing taxa (genera/species) if not letting it to default</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Specifying different thresholds</span>
example_size_corr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/correct_size.html">correct_size</a></span>(example_status_corr,
  <span class="dt">species_col =</span> <span class="st">"binomial_name"</span>, 
  <span class="dt">positive_growth_threshold =</span> <span class="dv">4</span>, <span class="co">#in cm(diameter)/year</span>
  <span class="dt">negative_growth_threshold =</span> <span class="op">-</span><span class="fl">1.5</span>, <span class="co">#in cm(diameter), absolute</span>
  <span class="dt">pioneers =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Albizia"</span>), 
  <span class="dt">pioneers_treshold =</span> <span class="dv">7</span>)<span class="co">#in cm(diameter)/year</span>
  
  <span class="co"># Letting all to default with out example dataset</span>
example_size_corr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/correct_size.html">correct_size</a></span>(example_status_corr, <span class="dt">species_col=</span><span class="st">"binomial_name"</span>)</code></pre></div>
</div>
<div id="use-correct_recruits-to-spot-and-correct-overgrown-recruits" class="section level2">
<h2 class="hasAnchor">
<a href="#use-correct_recruits-to-spot-and-correct-overgrown-recruits" class="anchor"></a>Use <code>correct_recruits</code> to spot and correct overgrown recruits</h2>
<p><code>correct_recruits</code> spots overgrown recruits according to the specified minimum diameter limit, and a tolerated growth threshold. It adds lines to the dataset corresponding to overgrown recruits’ hypothetical sizes before first record. These lines are tagged with the column “corrected_recruits” (FALSE for regular data, TRUE for lines generated with this function). For those, only the corrected size (size_corr) is specified along with tree ID and invariant columns. The columns originally containing size, POM and life status (raw and corrected) are let to NA.</p>
<p>Corrected size values for overgrown recruits should not be used to compute growth rates, and more generally, we advise to use this correction only for the specific cases that absolutely require it. Before correcting for overgrown recruits, we advise to correct life statuses and sizes beforehand.</p>
<p>Here is the full call of the function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example_recruits &lt;-<span class="st"> </span><span class="kw"><a href="../reference/correct_recruits.html">correct_recruits</a></span>(example_size_corr,
  <span class="dt">dbh_min =</span> <span class="dv">10</span>,
  <span class="dt">positive_growth_threshold =</span> <span class="dv">5</span>,
  <span class="dt">time_col =</span> <span class="st">"CensusYear"</span>,
  <span class="dt">id_col =</span> <span class="st">"idTree"</span>,
  <span class="dt">plot_col =</span> <span class="st">"Plot"</span>,
  <span class="dt">size_corr_col =</span> <span class="st">"size_corr"</span>, <span class="co">#because we already corrected</span>
  <span class="dt">status_corr_col =</span> <span class="st">"status_corr"</span>, <span class="co"># both size and status</span>
  <span class="dt">measure_type =</span> <span class="st">"C"</span>,
  <span class="dt">invariant_columns =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forest"</span>, <span class="st">"Family"</span>, <span class="st">"Genus"</span>, <span class="st">"Species"</span>, <span class="st">"binomial_name"</span>),
  <span class="dt">byplot =</span> <span class="ot">TRUE</span>,
  <span class="dt">correct_status =</span> <span class="ot">FALSE</span>
)
<span class="co">#&gt; </span>
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|================================</span><span class="st">                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%</code></pre></div>
<p>The function has 12 arguments:</p>
<ul>
<li>The dataset to correct, a data.frame object.</li>
<li>The names of the 5 columns containing: <code>id_col</code> (tree IDs), <code>size_col</code> (tree sizes : circumference or diameter), <code>time_col</code> (census year), <code>status_col</code> (life status) and <code>plot_col</code> (plot, if relevant)</li>
<li>
<code>measure_type</code> (“C” or “D”) indicates whether measured are circumferences or diameters.</li>
<li>
<code>byplot</code>, TRUE or FALSE, indicates whether the correction should be done by plot or not. If not, no need to set <code>plot_col</code>.</li>
<li>
<code>positive_growth_threshold</code> is apositive (annual) tolerated growth rates, over which growth values are considered abnormal. These values are given in <em>cm(diameter)/year</em>.</li>
<li>
<code>invariant_columns</code> contains the names of the columns that do not vary with time for a given tree (in our example dataset, taxonomic information and Forest). If new lines corresponding to unseen trees are added, this variables will be set to their unique value, and the other variables will be let to NA.</li>
</ul>
<p>Short version with prepare_forestdata:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example_recruits &lt;-<span class="st"> </span><span class="kw"><a href="../reference/correct_recruits.html">correct_recruits</a></span>(example_size_corr,
  <span class="dt">dbh_min =</span> <span class="dv">10</span>,
  <span class="dt">positive_growth_threshold =</span> <span class="dv">5</span>,
  <span class="dt">invariant_columns =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forest"</span>, <span class="st">"Family"</span>, <span class="st">"Genus"</span>, <span class="st">"Species"</span>, <span class="st">"binomial_name"</span>)
)
<span class="co">#&gt; </span>
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|================================</span><span class="st">                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%</code></pre></div>
</div>
<div id="use-display_corrected_trees-to-generate-the-graphs-and-check-the-corrections-" class="section level2">
<h2 class="hasAnchor">
<a href="#use-display_corrected_trees-to-generate-the-graphs-and-check-the-corrections-" class="anchor"></a>Use <code>display_corrected_trees</code> to generate the graphs and check the corrections.</h2>
<p>Oncoming section</p>
</div>
<div id="additional-details-on-the-corrections" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-details-on-the-corrections" class="anchor"></a>Additional details on the corrections</h2>
<div id="size-corrections" class="section level3">
<h3 class="hasAnchor">
<a href="#size-corrections" class="anchor"></a>Size corrections</h3>
<p>Tree sizes measurements are essential information to study the dynamics of a forest plot over time, through tree stem growth rates. This implies a need to ensure that size measurements are correct. There is a consensus regarding the need to standardize these metrics using the same Point of Measurement (POM) for each tree whenever possible (breast height, 1.30m). However, some trees develop buttresses or defaults that prevent measuring stem size accurately at breast height, and imply to uprise the POM. Most of the error regarding tree size comes from either uncorrect to no report of POM shifts, or imprecisions using a measuring tape. We categorize size measurement errors according to the direction (negative, positive) and temporality (transient, permanent) of the anomalies.</p>
<div id="thresholds-and-pioneer-species" class="section level4">
<h4 class="hasAnchor">
<a href="#thresholds-and-pioneer-species" class="anchor"></a>Thresholds and pioneer species</h4>
<p>Except for explicit POM changes, anomalies are detected by <code>correct_size</code> using thresholds defining abnormal increase/decrease in tree size. These thresholds depend on the protocol applied for a given census (e.g., basal measurement error rate and field verification protocols, if any) as well as empirical considerations regarding tree growth.</p>
<p>For the Paracou Disturbance Experiment, an abnormal decrease is considered to be under -2cm (absolute, between-census <em>diameter</em> growth) and an abnormal increase is over 5cm/year (annual <em>diameter</em> growth). These apparently permissive thresholds are due to the 35 years of experience gained from the begining of the experiment, as well as intensive and strict field verifications (apurement protocol by A. Dourdain) carried out in parallel of the censusing campaigns, allowing to verificate directly most of the doubtful measurements.</p>
<p>In reality, some heliophilous species car grow far more rapidly than others, and can cause “false positive” anomaly detections. To avoid uprising the growth threshold and the chance of non-detection for real anomalies, it seems better to discriminate, at least grossly, this group of species: In <code>correct_size</code>, we added two arguments to specify a list of generally fast growing (pioneer) species or genera, and a greater positive growth threshold to apply to those species.</p>
<p>For Paracou, practical experience suggests that 7.5cm/year is a reasonable threshold for these species.</p>
<p>The choice of these thresholds is let to the user (although they default to values used for the Paracou database), and these must be set according to the dataset one wants to correct.</p>
</div>
<div id="punctual-errors" class="section level4">
<h4 class="hasAnchor">
<a href="#punctual-errors" class="anchor"></a>Punctual errors</h4>
<p>Punctual errors are transient, abnormal increases or decreases in tree size measurement, that eventually returns to “normal” values. This implies to define a threshold to discriminate “abnormal” increases and decreases, as well as the concept of “return-to-normal”.</p>
<p>In ForestData’s <code>correct_size</code> function, we considered that an error is punctual if one of the two next census’ values present a similar change in size, with opposite direction, that counterbalances the anomaly. These can be caused by an erroneous measurement or estimation of tree size at a given census, more rarely for two consecutive censuses.</p>
<p>Punctual errors are corrected by replacing the abnormal values with more reasonable estimates. That is simply done by linearily interpolating these value between the no-NA measurements surrounding the anomaly: right before the increa/decrease, and at the “return-to-normal” point.</p>
</div>
<div id="permanent-errors-or-shifts" class="section level4">
<h4 class="hasAnchor">
<a href="#permanent-errors-or-shifts" class="anchor"></a>Permanent errors, or shifts</h4>
<p>Permanent errors or shifts are definitive uprises or downrises of size measurement values, with no detectable “return-to-normal” point.</p>
<p>In most of the case, these are permanent decreases due to POM change: when POM is uprisen, due to the semi-conic shape of the trunk, the measured size is inferior than if it was measured accurately at breast height. Shifts can also (more rarely) be caused by size estimation rather than measurement (or even to the transition from estimation to actual measurement), for stems showing a highly non-cylindric conformation, and may be positive or negative in such cases.</p>
<p>In <code>correct_size</code>, shifts are corrected using two methods: * Explicitely, for reported POM shifts, i.e. the sum of the difference in sizes before and after POM change and the expected growth value (linear interpolation) is added to the following size measurements, graphically resulting in a translation of the size trajectory after the POM uprise. * Upon detection, for anomalies without detected “return-to-normal”, by re-aligning on the longest series of measurement (or the most recent, if both have the same number of points)</p>
</div>
</div>
<div id="overgrown-recruits" class="section level3">
<h3 class="hasAnchor">
<a href="#overgrown-recruits" class="anchor"></a>Overgrown recruits</h3>
<p>Most forest inventories focus on trees with DBH over 10cm, or sometimes 1cm. Every tree (or stem) is, supposedly, tagged with a label at the first inventory and followed accross censuses. Recruited trees are newcomers that pass the minimum censusing diameter limit between two campaigns. Ideally, one expects these tree to measure just a few more than this limit, especially if the temporal resolution of the inventory is low - trees generally grow slowly. Having defined a growth threshold T (in cm/year) and with I, the interval between two census (in years), the size of a tree at recruitment time should not exceed 10+T*I.</p>
<p>Overgrown recruits are trees that violate this assumption, generally because those weren’t noticed before, for some reason. These individuals can be problematic when it comes to estimate basal area or biomass, especially if they are adult trees. <code>correct_recruits</code> re-creates the previous growth trajectory of those trees using linear extrapolation.</p>
<p>Being highly hypothetical, corrected size values for overgrown recruits should not be used to compute growth rates, and more generally, we advise to use this correction only for the specific cases that absolutely require it.</p>
</div>
</div>
</div>
<div id="use-forestdata-to-compute-and-display-classical-metrics-in-forest-ecology" class="section level1">
<h1 class="hasAnchor">
<a href="#use-forestdata-to-compute-and-display-classical-metrics-in-forest-ecology" class="anchor"></a>Use ForestData to compute and display classical metrics in Forest Ecology</h1>
<p>In addition to the corrections the package provides functions to compute and display the classical metrics used in Forest Science: annual or absolute growth rates, annual recruitment and mortality rates, and basal area. In this section, we will go through examples of these features to show the possibilities of these tools.</p>
<div id="compute-and-display-mortality-and-growth-rates-or-both" class="section level2">
<h2 class="hasAnchor">
<a href="#compute-and-display-mortality-and-growth-rates-or-both" class="anchor"></a>Compute and display mortality and growth rates, or both</h2>
<p>The functions <code>compute_mortality</code> and <code>compute_recruitment</code> compute annual mortality or recruitment rates by plot or globally.</p>
<p>Let’s see an example with our built-in dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(example_status_corr)

## Full calls for the corrected dataset
mortality &lt;-<span class="st"> </span><span class="kw"><a href="../reference/compute_mortality.html">compute_mortality</a></span>(example_status_corr, 
 <span class="dt">status_col=</span><span class="st">"status_corr"</span>, <span class="co">#When corrected is set to FALSE, correct_alive is triggered, thus remember to specify the column containing uncorrected tree statuses.</span>
 <span class="dt">time_col=</span><span class="st">"CensusYear"</span>,
 <span class="dt">id_col=</span><span class="st">"idTree"</span>,
 <span class="dt">dead_confirmation_censuses=</span><span class="dv">2</span>,
 <span class="dt">byplot =</span> <span class="ot">TRUE</span>,
 <span class="dt">plot_col =</span> <span class="st">"Plot"</span>,
 <span class="dt">corrected =</span> <span class="ot">TRUE</span>)

recruitment &lt;-<span class="st"> </span><span class="kw"><a href="../reference/compute_recruitment.html">compute_recruitment</a></span>(example_status_corr,
 <span class="dt">status_col=</span><span class="st">"status_corr"</span>, <span class="co">#When corrected is set to FALSE, correct_alive is triggered, thus remember to specify the column containing uncorrected tree statuses.</span>
 <span class="dt">time_col=</span><span class="st">"CensusYear"</span>,
 <span class="dt">id_col=</span><span class="st">"idTree"</span>,
 <span class="dt">dead_confirmation_censuses=</span><span class="dv">2</span>,
 <span class="dt">byplot =</span> <span class="ot">TRUE</span>,
 <span class="dt">plot_col =</span> <span class="st">"Plot"</span>,
 <span class="dt">corrected =</span> <span class="ot">TRUE</span>)

<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(mortality); <span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(recruitment)
<span class="co">#&gt;       interval       time      annual_deathrate        plot      </span>
<span class="co">#&gt;  1995_1997: 2   Min.   :1985   Min.   :0.005123   Min.   :1.000  </span>
<span class="co">#&gt;  1997_1999: 2   1st Qu.:1989   1st Qu.:0.007343   1st Qu.:1.000  </span>
<span class="co">#&gt;  1999_2001: 2   Median :1992   Median :0.009513   Median :1.000  </span>
<span class="co">#&gt;  1984_1985: 1   Mean   :1993   Mean   :0.009889   Mean   :1.727  </span>
<span class="co">#&gt;  1985_1986: 1   3rd Qu.:1996   3rd Qu.:0.011517   3rd Qu.:3.000  </span>
<span class="co">#&gt;  1986_1987: 1   Max.   :2001   Max.   :0.022355   Max.   :3.000  </span>
<span class="co">#&gt;  (Other)  :13</span>
<span class="co">#&gt;       interval       time      annual_recruitment_rate plot  </span>
<span class="co">#&gt;  1995_1997: 2   Min.   :1985   Min.   :0.002039        1:14  </span>
<span class="co">#&gt;  1997_1999: 2   1st Qu.:1989   1st Qu.:0.007375        3: 8  </span>
<span class="co">#&gt;  1999_2001: 2   Median :1992   Median :0.044086              </span>
<span class="co">#&gt;  1984_1985: 1   Mean   :1993   Mean   :0.072152              </span>
<span class="co">#&gt;  1985_1986: 1   3rd Qu.:1996   3rd Qu.:0.124529              </span>
<span class="co">#&gt;  1986_1987: 1   Max.   :2001   Max.   :0.239983              </span>
<span class="co">#&gt;  (Other)  :13</span></code></pre></div>
<p>Both functions return comparable outputs and have the same arguments:</p>
<ul>
<li>
<code>data</code>, the dataset (hopefully corrected with <code><a href="../reference/correct_alive.html">correct_alive()</a></code> beforehand)</li>
<li>
<code>status_col</code>, which defaults to “status_corr” and should stay unchanged</li>
<li>
<code>time_col</code>, the name of the column containig census year</li>
<li>
<code>id_col</code>, the name of the column containig unique tree ids</li>
<li>
<code>dead_confirmation_censuses</code>, an argument related to <code><a href="../reference/correct_alive.html">correct_alive()</a></code>: the number of consecutive census after which unseen trees are considered dead. The choice of this value for corrections imply that mortality rates cannot be computed for the last (dead_confirmation_censuses - 1) censuses. Although it does not impact recruitment rate computation, this constraint has been included in both functions because both metrics are often jointly examined.</li>
<li>
<code>byplot</code> (TRUE of FALSE) that indicates if rates must be computed separately for each plot, or globally</li>
<li>
<code>plot_col</code>, the name of the column indicating plots</li>
<li>
<code>corrected</code>, an argument set to TRUE that otherwise triggers <code><a href="../reference/correct_alive.html">correct_alive()</a></code> before computing mortality. This option is there to save time and do corrections uniquely to compute these metrics.</li>
</ul>
<p>The functions arguments can be fully specified, or the call can also be simplified if using <code>prepare_forestdata</code>. This also works:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mortality &lt;-<span class="st"> </span><span class="kw"><a href="../reference/compute_mortality.html">compute_mortality</a></span>(data,
                  <span class="dt">status_col=</span><span class="st">"status_corr"</span>,
                  <span class="dt">dead_confirmation_censuses=</span><span class="dv">2</span>)

recruitment &lt;-<span class="st"> </span><span class="kw"><a href="../reference/compute_recruitment.html">compute_recruitment</a></span>(data,
                                   <span class="dt">status_col=</span><span class="st">"status_corr"</span>,
                                   <span class="dt">dead_confirmation_censuses=</span><span class="dv">2</span>)</code></pre></div>
<p>When the argument <code>corrected = TRUE</code>, just remember to specify the name of the column containing uncorrected tree life status, and do everything else normally, for example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(example_census)
mortality &lt;-<span class="st"> </span><span class="kw"><a href="../reference/compute_mortality.html">compute_mortality</a></span>(data,
                  <span class="dt">status_col=</span><span class="st">"CodeAlive"</span>,<span class="co">#Raw tree status</span>
                  <span class="dt">dead_confirmation_censuses=</span><span class="dv">2</span>,
                  <span class="dt">corrected =</span> F)

recruitment &lt;-<span class="st"> </span><span class="kw"><a href="../reference/compute_recruitment.html">compute_recruitment</a></span>(data,
                                   <span class="dt">status_col=</span><span class="st">"CodeAlive"</span>,<span class="co">#Raw tree status</span>
                                   <span class="dt">dead_confirmation_censuses=</span><span class="dv">2</span>,
                                   <span class="dt">corrected =</span> F)</code></pre></div>
<p>The package also includes <code>compute_rates</code>, a wrapper for the previous functions that allows to compute both rates jointly:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(example_status_corr)
<span class="co"># Full Call</span>
rates &lt;-<span class="st"> </span><span class="kw"><a href="../reference/compute_rates.html">compute_rates</a></span>(example_status_corr,
                       <span class="dt">status_col=</span><span class="st">"status_corr"</span>,
                       <span class="dt">time_col=</span><span class="st">"CensusYear"</span>,
                       <span class="dt">id_col=</span><span class="st">"idTree"</span>,
                       <span class="dt">dead_confirmation_censuses=</span><span class="dv">2</span>,
                       <span class="dt">byplot =</span> <span class="ot">TRUE</span>,
                       <span class="dt">plot_col =</span> <span class="st">"Plot"</span>,
                       <span class="dt">corrected =</span> <span class="ot">TRUE</span>)
<span class="co"># Simplified Call</span>
rates &lt;-<span class="st"> </span><span class="kw"><a href="../reference/compute_rates.html">compute_rates</a></span>(example_status_corr,
                       <span class="dt">status_col=</span><span class="st">"status_corr"</span>,
                       <span class="dt">dead_confirmation_censuses=</span><span class="dv">2</span>)

<span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(rates)
<span class="co">#&gt; 'data.frame':    22 obs. of  5 variables:</span>
<span class="co">#&gt;  $ interval               : Factor w/ 19 levels "1984_1985","1985_1986",..: 1 2 15 3 4 16 5 6 17 7 ...</span>
<span class="co">#&gt;  $ time                   : int  1985 1986 1987 1987 1988 1989 1989 1990 1991 1991 ...</span>
<span class="co">#&gt;  $ plot                   : Factor w/ 2 levels "1","3": 1 1 2 1 1 2 1 1 2 1 ...</span>
<span class="co">#&gt;  $ annual_recruitment_rate: num  0.02412 0.00404 0.12095 0.01012 0.00609 ...</span>
<span class="co">#&gt;  $ annual_deathrate       : num  0.00716 0.00905 0.01198 0.01212 0.0081 ...</span></code></pre></div>
<p>The use of <code>corrected = FALSE</code> is similar to what we saw above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(example_census)
<span class="kw"><a href="../reference/compute_rates.html">compute_rates</a></span>(example_census,
              <span class="dt">status_col =</span> <span class="st">"CodeAlive"</span>,<span class="co">#Raw tree statuses</span>
              <span class="dt">dead_confirmation_censuses=</span><span class="dv">2</span>,
              <span class="dt">corrected=</span>F)</code></pre></div>
<div id="display-mortality-and-growth-rates" class="section level3">
<h3 class="hasAnchor">
<a href="#display-mortality-and-growth-rates" class="anchor"></a>Display mortality and growth rates</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/display_mortality.html">display_mortality</a></span>(mortality)
<span class="co">#&gt; Loading package ggplot2 for the function display_rates to run.</span>
<span class="co">#&gt; Le chargement a nécessité le package : package</span>
<span class="co">#&gt; Warning in library(package, lib.loc = lib.loc, character.only = TRUE,</span>
<span class="co">#&gt; logical.return = TRUE, : aucun package nommé 'package' n'est trouvé</span></code></pre></div>
<p><img src="forestdata-vignette_files/figure-html/display_mort-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/display_recruitment.html">display_recruitment</a></span>(recruitment)</code></pre></div>
<p><img src="forestdata-vignette_files/figure-html/display_rec-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(example_status_corr)
rates &lt;-<span class="st"> </span><span class="kw"><a href="../reference/compute_rates.html">compute_rates</a></span>(example_status_corr)
 <span class="kw"><a href="../reference/display_rates.html">display_rates</a></span>(<span class="dt">rates =</span> rates)</code></pre></div>
<p><img src="forestdata-vignette_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
</div>
</div>
<div id="compute-and-display-basal_area-with-compute_ba-and-display_ba" class="section level2">
<h2 class="hasAnchor">
<a href="#compute-and-display-basal_area-with-compute_ba-and-display_ba" class="anchor"></a>Compute and display basal_area with <code>compute_ba</code> and <code>display_ba</code>
</h2>
</div>
<div id="compute-and-display-annual-and-absolute-growth-with-compute_growth-and-display_growth" class="section level2">
<h2 class="hasAnchor">
<a href="#compute-and-display-annual-and-absolute-growth-with-compute_growth-and-display_growth" class="anchor"></a>Compute and display annual and absolute growth with <code>compute_growth</code> and <code>display_growth</code>
</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(example_size_corr)
growth &lt;-<span class="st"> </span><span class="kw"><a href="../reference/compute_growth.html">compute_growth</a></span>(example_size_corr,
                         <span class="dt">size_col =</span> <span class="st">"size_corr"</span>,
                         <span class="dt">measure_type =</span> <span class="st">"cir"</span>,
                         <span class="dt">status_col =</span> <span class="st">"CodeAlive"</span>,
                         <span class="dt">id_col=</span> <span class="st">"idTree"</span>,
                         <span class="dt">time_col =</span> <span class="st">"CensusYear"</span>,
                         <span class="dt">what_output =</span> <span class="st">"annual"</span>,
                         <span class="dt">aggregate =</span> T,
                         <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Plot"</span>),
                         <span class="dt">stat =</span> <span class="st">"mean"</span>,
                         <span class="dt">percentiles =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5</span>,<span class="dv">95</span>))
<span class="co">#&gt; Warning in compute_growth(example_size_corr, size_col = "size_corr",</span>
<span class="co">#&gt; measure_type = "cir", : There are NA values in size measurements and/or</span>
<span class="co">#&gt; census time fields. These lines were deleted because a growth rate cannot</span>
<span class="co">#&gt; be computed, thus not included in the output table.</span>
<span class="co">#&gt; The growth rates were not computed when tree life status was 0 (dead) or NA (unseen or uncertain), thus the growth rate on these lines was set to NA</span>

<span class="kw"><a href="../reference/display_growth.html">display_growth</a></span>(growth)
<span class="co">#&gt; $mapping</span>
<span class="co">#&gt; Aesthetic mapping: </span>
<span class="co">#&gt; * `ymin` -&gt; `P95`</span>
<span class="co">#&gt; * `ymax` -&gt; `P5`</span>
<span class="co">#&gt; * `fill` -&gt; `Plot`</span>
<span class="co">#&gt; * `x`    -&gt; `time`</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $alpha</span>
<span class="co">#&gt; [1] 0.4</span></code></pre></div>
<p><img src="forestdata-vignette_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># growth &lt;- compute_growth(example_census)</span>
<span class="co"># growth %&gt;% filter(annual_growth&lt;0)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#what-is-forestdata">What is ForestData ?</a></li>
      <li><a href="#install-and-load-the-package">Install and load the package</a></li>
      <li>
<a href="#use-forestdata-to-correct-dendrometric-censuses-data">Use ForestData to correct dendrometric censuses data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#prepare-your-dataset">Prepare your dataset</a></li>
      <li><a href="#use-correct_alive-to-correct-tree-life-status-errors-in-your-dataset">Use <code>correct_alive</code> to correct tree life status errors in your dataset</a></li>
      <li><a href="#use-correct_size-to-correct-tree-size-measurements">Use <code>correct_size</code> to correct tree size measurements</a></li>
      <li><a href="#use-correct_recruits-to-spot-and-correct-overgrown-recruits">Use <code>correct_recruits</code> to spot and correct overgrown recruits</a></li>
      <li><a href="#use-display_corrected_trees-to-generate-the-graphs-and-check-the-corrections-">Use <code>display_corrected_trees</code> to generate the graphs and check the corrections.</a></li>
      <li><a href="#additional-details-on-the-corrections">Additional details on the corrections</a></li>
      </ul>
</li>
      <li>
<a href="#use-forestdata-to-compute-and-display-classical-metrics-in-forest-ecology">Use ForestData to compute and display classical metrics in Forest Ecology</a><ul class="nav nav-pills nav-stacked">
<li><a href="#compute-and-display-mortality-and-growth-rates-or-both">Compute and display mortality and growth rates, or both</a></li>
      <li><a href="#compute-and-display-basal_area-with-compute_ba-and-display_ba">Compute and display basal_area with <code>compute_ba</code> and <code>display_ba</code></a></li>
      <li><a href="#compute-and-display-annual-and-absolute-growth-with-compute_growth-and-display_growth">Compute and display annual and absolute growth with <code>compute_growth</code> and <code>display_growth</code></a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Géraldine Derroire, Bruno Hérault, Eric Marcon, Elie Guedj, Gaëlle Jaouen, Camille Piponiot.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
